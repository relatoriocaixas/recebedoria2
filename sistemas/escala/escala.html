<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Escala — Portal Unificado</title>
  <link rel="stylesheet" href="../../style.css">

  <style>
    /* Container principal */
    .escala-wrap {  
      padding:18px;
      color:var(--text);
      height:100vh;
      display:flex;
      flex-direction:column;
      gap:12px;
      overflow-y:auto;
      visibility:hidden;
    }

    /* Barra de controles */
    .controls {
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
    }

    select, input, button, textarea {
      background: rgba(20,20,20,0.6);
      border:1px solid rgba(255,255,255,0.04);
      color:var(--text);
      padding:8px;
      border-radius:6px;
      font-size:0.9rem;
    }

    button.primary {
      background:#4da6ff;
      color:#fff;
      border:none;
      cursor:pointer;
      transition: background 0.2s ease;
    }
    button.primary:hover {
      background:#3399ff;
    }

    .adminOnly { display:inline-block; }
    #horarioWrapper { display:none; }

    /* Calendário */
    .calendar {
      background: rgba(10,10,10,0.45);
      border-radius:8px;
      padding:12px;
      flex:1;
      overflow:auto;
      margin-top:12px;
      transform: scale(0.9);
      transform-origin: top left;
      width: 90%;
      margin-left: 5%; /* desloca o calendário mais para a direita */
    }

    .weeknames {
      display:grid;
      grid-template-columns:repeat(7,1fr);
      gap:6px;
      margin-bottom:6px;
    }

    .weeknames div {
      text-align:center;
      color:var(--muted);
      font-size:0.85rem;
      font-weight:500;
    }

    .grid {
      display:grid;
      grid-template-columns:repeat(7,1fr);
      gap:6px;
    }

    .day {
      min-height:90px;
      background:rgba(255,255,255,0.02);
      border-radius:6px;
      padding:4px;
      position:relative;
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      justify-content:flex-start;
      gap:2px;
      cursor:default;
      transition:background 0.2s ease;
    }

    .day:hover { background:rgba(255,255,255,0.05); }

    .day .num {
      position:absolute;
      top:5px;
      right:6px;
      font-weight:700;
      font-size:0.85rem;
      color:var(--muted);
    }

    /* Badges de folgas/trocas */
    .day .badges {
      margin-top:18px;
      display:flex;
      flex-wrap:wrap;
      gap:4px;
      max-height:none;
      overflow:visible;
    }

    .badge {
      font-size:0.7rem;
      font-weight:500;
      color:#fff;
      padding:2px 5px;
      border-radius:4px;
      position:relative;
      cursor:default;
      user-select:none;
      white-space:nowrap;
      flex: 1 1 calc(25% - 4px); /* até 4 por linha */
      text-align:center;
    }

    .badge.folga { background:#4da6ff; }
    .badge.troca {
      background:#ffb347;
      color:#000;
      font-weight:600;
      box-shadow:0 0 4px #ff9f40;
    }

    .badge:hover::after {
      content: attr(data-tooltip);
      position:absolute;
      top:-26px;
      left:0;
      background: rgba(0,0,0,0.85);
      color:#fff;
      padding:3px 6px;
      font-size:0.65rem;
      border-radius:4px;
      white-space:nowrap;
      z-index:10;
    }

    @media(max-width:800px){
      .grid .day { min-height:72px; }
      .controls label { flex:1 1 100%; }

      .calendar {
        transform: scale(0.85);
        width: 118%;
        margin-left: 0;
      }

      .day .badge {
        flex: 1 1 calc(33.33% - 4px);
      }
    }
  </style>
</head>

<body>
  <div class="escala-wrap">
    <div class="controls">
      <label>Matrícula:
        <select id="selectMatricula"></select>
      </label>

      <label>Período:
        <select id="selectPeriodo">
          <option value="manha">Manhã</option>
          <option value="tarde">Tarde</option>
          <option value="noite">Noite</option>
        </select>
      </label>

      <label>Tipo:
        <select id="selectTipo">
          <option value="folga">Folga</option>
          <option value="troca">Troca de horário</option>
        </select>
      </label>

      <label>Dia:
        <input type="date" id="inputDia" />
      </label>

      <div id="horarioWrapper">
        <label>Horário:
          <input type="text" id="inputHorario" placeholder="Ex: 14:00-18:00" />
        </label>
      </div>

      <button id="btnSalvar" class="primary adminOnly">Salvar</button>

      <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <button id="prevMonth">◀</button>
        <div id="monthLabel" class="small-muted"></div>
        <button id="nextMonth">▶</button>
      </div>
    </div>

    <div class="calendar">
      <div class="weeknames">
        <div>Dom</div><div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>Sáb</div>
      </div>
      <div id="calGrid" class="grid"></div>
    </div>
  </div>

  <script type="module" src="escala.js"></script>
</body>
</html>
